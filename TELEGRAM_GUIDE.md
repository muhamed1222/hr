# ü§ñ Telegram –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ

## ‚úÖ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1. –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- üìù **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–±–æ—á–∏—Ö –ª–æ–≥–æ–≤** - —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –ø–æ–ª—É—á–∞—é—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏—Ö –¥–∞–Ω–Ω—ã—Ö –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º
- üìä **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —ç–∫—Å–ø–æ—Ä—Ç–µ –æ—Ç—á—ë—Ç–æ–≤** - –º–µ–Ω–µ–¥–∂–µ—Ä—ã –ø–æ–ª—É—á–∞—é—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ —Å–æ–∑–¥–∞–Ω–∏–∏ Excel/PDF –æ—Ç—á—ë—Ç–æ–≤
- üß™ **–¢–µ—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è** - –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã

### 2. API Endpoints
- `POST /api/telegram/test` - –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
- `POST /api/telegram/send` - –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è  
- `GET /api/telegram/bot-info` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–æ—Ç–µ

### 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Å–∏—Å—Ç–µ–º—É
- ‚úÖ –ü—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –ª–æ–≥–æ–≤ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- ‚úÖ –ü—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ –æ—Ç—á—ë—Ç–æ–≤ –º–µ–Ω–µ–¥–∂–µ—Ä—ã –ø–æ–ª—É—á–∞—é—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ - —Å–±–æ–∏ Telegram –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ –æ—Å–Ω–æ–≤–Ω—É—é —Ä–∞–±–æ—Ç—É

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –®–∞–≥ 1: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–æ–π chat_id

1. –ù–∞–π–¥–∏—Ç–µ –±–æ—Ç–∞ `@hr_oc_bot` –≤ Telegram
2. –ù–∞–ø–∏—à–∏—Ç–µ –±–æ—Ç—É `/start`
3. –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: https://api.telegram.org/bot7825920966:AAGBim6tbpeGnwocHi5a2YUm3QrdnhKzzBA/getUpdates
4. –í –æ—Ç–≤–µ—Ç–µ –Ω–∞–π–¥–∏—Ç–µ –≤–∞—à `chat_id`:

```json
{
  "result": [
    {
      "message": {
        "chat": {
          "id": 123456789  ‚Üê –≤–∞—à chat_id
        }
      }
    }
  ]
}
```

### –®–∞–≥ 2: –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

```bash
# –¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
node test-telegram.js YOUR_CHAT_ID

# –ò–ª–∏ —á–µ—Ä–µ–∑ API
curl -X POST http://localhost:3000/api/telegram/test \
  -H "Content-Type: application/json" \
  -d '{"chatId": "YOUR_CHAT_ID"}'
```

### –®–∞–≥ 3: –î–æ–±–∞–≤–∏—Ç—å chat_id –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

```sql
-- –î–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
UPDATE users SET telegram_id = 'YOUR_CHAT_ID' WHERE username = 'employee_username';

-- –î–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞  
UPDATE users SET telegram_id = 'YOUR_CHAT_ID' WHERE username = 'admin';
```

## üìã –ü—Ä–∏–º–µ—Ä—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –ª–æ–≥–∞
```
üìù –í–∞—à —Ä–∞–±–æ—á–∏–π –¥–µ–Ω—å –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω

üóì –î–∞—Ç–∞: 2024-12-19
üë§ –ú–µ–Ω–µ–¥–∂–µ—Ä: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä

–ò–∑–º–µ–Ω–µ–Ω–∏—è:
‚Ä¢ –í—Ä–µ–º—è –ø—Ä–∏—Ö–æ–¥–∞: 09:30:00
‚Ä¢ –í—Ä–µ–º—è —É—Ö–æ–¥–∞: 18:00:00
‚Ä¢ –û—Ç—á—ë—Ç –æ —Ä–∞–±–æ—Ç–µ: –ó–∞–≤–µ—Ä—à–∏–ª –ø—Ä–æ–µ–∫—Ç

‚ÑπÔ∏è –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ —Å–∏—Å—Ç–µ–º–µ.
```

### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —ç–∫—Å–ø–æ—Ä—Ç–µ –æ—Ç—á—ë—Ç–∞
```
üìä –û—Ç—á—ë—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω

üìà –¢–∏–ø: Excel –æ—Ç—á—ë—Ç
üóì –ü–µ—Ä–∏–æ–¥: 2024-12-10 - 2024-12-19
‚è∞ –í—Ä–µ–º—è: 19.12.2024, 15:30:25

‚úÖ –§–∞–π–ª –≥–æ—Ç–æ–≤ –∫ —Å–∫–∞—á–∏–≤–∞–Ω–∏—é –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏.
```

## ‚öôÔ∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (.env)
```env
TELEGRAM_BOT_TOKEN=7825920966:AAGBim6tbpeGnwocHi5a2YUm3QrdnhKzzBA
```

### –û—Å–Ω–æ–≤–Ω–∞—è —É—Ç–∏–ª–∏—Ç–∞
```javascript
// src/utils/sendTelegramMessage.js
await notifyWorkLogEdited(userTelegramId, workDate, managerName, changes);
await notifyReportExported(managerTelegramId, reportType, period);
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –º–∞—Ä—à—Ä—É—Ç—ã
- `src/routes/workLogs.js` - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ PATCH –∑–∞–ø—Ä–æ—Å–∞—Ö
- `src/routes/reports.js` - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ –æ—Ç—á—ë—Ç–æ–≤

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ –¢–æ–∫–µ–Ω —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚úÖ Graceful error handling - –æ—à–∏–±–∫–∏ Telegram –Ω–µ –ª–æ–º–∞—é—Ç –æ—Å–Ω–æ–≤–Ω—É—é —Å–∏—Å—Ç–µ–º—É
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ç–æ–∫–µ–Ω–∞ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
- ‚úÖ Timeout 10 —Å–µ–∫—É–Ω–¥ –¥–ª—è HTTP –∑–∞–ø—Ä–æ—Å–æ–≤

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞
node test-telegram.js

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –±–æ—Ç–µ
curl http://localhost:3000/api/telegram/bot-info

# –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
curl -X POST http://localhost:3000/api/telegram/test \
  -H "Content-Type: application/json" \
  -d '{"chatId": "YOUR_CHAT_ID"}'
```

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ü–æ–ª—É—á–∏—Ç–µ –≤–∞—à chat_id** –∏—Å–ø–æ–ª—å–∑—É—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤—ã—à–µ
2. **–û–±–Ω–æ–≤–∏—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö** —Å –≤–∞—à–∏–º telegram_id  
3. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ** - –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –ª—é–±–æ–π –ª–æ–≥ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ** - –¥–æ–ª–∂–Ω–æ –ø—Ä–∏–π—Ç–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram

---

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ  
**–í–µ—Ä—Å–∏—è**: 1.0  
**–î–∞—Ç–∞**: 19.12.2024 